#!/bin/bash

# Test Voice Recognition Feature
# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

set -e

echo "üé§ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≥–æ–ª–æ—Å–∞..."
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
if [ -z "$BOT_TOKEN" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: BOT_TOKEN=your_token ./scripts/test-voice.sh"
    exit 1
fi

if [ -z "$YANDEX_API_KEY" ]; then
    echo "‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: YANDEX_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
    echo "–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç YANDEX_API_KEY –∏ YANDEX_FOLDER_ID"
fi

if [ -z "$YANDEX_FOLDER_ID" ]; then
    echo "‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: YANDEX_FOLDER_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

echo ""
echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:"
echo ""
echo "1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ:"
echo "   npm run dev"
echo ""
echo "2. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram"
echo ""
echo "3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤ —á–∞—Ç–µ"
echo ""
echo "4. –ó–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ"
echo "   –ü—Ä–∏–º–µ—Ä—ã:"
echo "   - '–ò–¥–µ—è –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞'"
echo "   - '–ü—Ä–∏–¥—É–º–∞–π —á—Ç–æ-—Ç–æ –¥–ª—è –ø—Ä–æ–¥–∞–∂'"
echo "   - 'HR —Ä–µ—à–µ–Ω–∏–µ —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º'"
echo ""
echo "5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
echo ""
echo "6. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω:"
echo "   - –†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≤–∞—à—É —Ä–µ—á—å"
echo "   - –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç"
echo "   - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-–∏–¥–µ—é"
echo ""
echo "‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã —É–≤–∏–¥–∏—Ç–µ:"
echo "   üé§ –°–ª—É—à–∞—é –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
echo "   üîç –†–∞—Å–ø–æ–∑–Ω–∞—é –≤–∞—à—É —Ä–µ—á—å..."
echo "   üìù –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: '[–≤–∞—à —Ç–µ–∫—Å—Ç]'"
echo "   üí° –ì–µ–Ω–µ—Ä–∏—Ä—É—é –±–∏–∑–Ω–µ—Å-–∏–¥–µ—é..."
echo "   üéØ –ë–∏–∑–Ω–µ—Å-–∏–¥–µ—è: [–∏–¥–µ—è]"
echo ""
echo "‚ùå –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:"
echo "   - '–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã' ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏"
echo "   - '–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å' ‚Üí –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≥—Ä–æ–º—á–µ –∏ —á—ë—Ç—á–µ"
echo "   - '–°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ' ‚Üí –º–∞–∫—Å. 30 —Å–µ–∫—É–Ω–¥"
echo ""
echo "üîß –û—Ç–ª–∞–¥–∫–∞:"
echo "   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ (npm run dev)"
echo "   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ YANDEX_API_KEY –∏ YANDEX_FOLDER_ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ"
echo "   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –µ—Å—Ç—å —Ä–æ–ª—å ai.speechkit-stt.user"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram API
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram..."
response=$(curl -s "https://api.telegram.org/bot${BOT_TOKEN}/getMe")

if echo "$response" | grep -q '"ok":true'; then
    bot_name=$(echo "$response" | grep -o '"first_name":"[^"]*"' | cut -d'"' -f4)
    bot_username=$(echo "$response" | grep -o '"username":"[^"]*"' | cut -d'"' -f4)
    echo "‚úÖ –ë–æ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω: $bot_name (@$bot_username)"
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–æ—Ç—É"
    echo "–û—Ç–≤–µ—Ç API: $response"
    exit 1
fi

echo ""
echo "üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!"
echo ""
